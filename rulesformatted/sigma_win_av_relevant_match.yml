import: globalconfig.txt
 
alert:
- slack
- hivealerter
 
description: This detection method points out highly relevant Antivirus events
filter:
- query:
    query_string:
      query: ((HTool OR Hacktool OR ASP\/Backdoor OR JSP\/Backdoor OR PHP\/Backdoor
        OR Backdoor.ASP OR Backdoor.JSP OR Backdoor.PHP OR Webshell OR Portscan OR
        Mimikatz OR WinCred OR PlugX OR Korplug OR Pwdump OR Chopper OR WmiExec OR
        Xscan OR Clearlog OR ASPXSpy) AND NOT (Keygen OR Crack))
index: logs-endpoint-winevent-application-*
name: Relevant-Anti-Virus-Event_0
priority: 2
realert:
  minutes: 0
type: any

alert_text: "
	EventId: {0}\n
        Timestamp: {1}\n
        Index: {2}\n"

alert_text_args: ["event_id", "@timestamp","_id"]
alert_text_type: alert_text_only

hive_alert_config:
    title: "{rule[name]}"
    type: "external"
    source: "Elastalert"
    description: "This detection method points out highly relevant Antivirus events "
    severity: "2"
    tags: ["Security Alert", "Suspicious", "{match[event_id]}"]
    tlp: 1
    status: "New"
    follow: True

hive_observable_data_mapping:
  - index: "{match[_index]}"
  - timestamp: "{match[@timestamp]}"
  - event id: "{match[event_id]}"

